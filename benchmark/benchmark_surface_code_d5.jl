using QuantumClifford
using QuantumCliffordGPU
using BenchmarkTools
using Plots
using ProgressBars

# QuantumClifford Program
circ = [
    # sMRZ(0, 0),
    sMRZ(2, 0),
    sMRZ(4, 0),
    sMRZ(6, 0),
    sMRZ(8, 0),
    sMRZ(10, 0),
    sMRZ(12, 0),
    sMRZ(14, 0),
    sMRZ(16, 0),
    sMRZ(18, 0),
    sMRZ(20, 0),
    sMRZ(22, 0),
    sMRZ(24, 0),
    sMRZ(26, 0),
    sMRZ(28, 0),
    sMRZ(30, 0),
    sMRZ(32, 0),
    sMRZ(34, 0),
    sMRZ(36, 0),
    sMRZ(38, 0),
    sMRZ(40, 0),
    sMRZ(42, 0),
    sMRZ(44, 0),
    sMRZ(46, 0),
    sMRZ(48, 0),
    sMRZ(50, 0),
    sMRZ(52, 0),
    sMRZ(54, 0),
    sMRZ(56, 0),
    sMRZ(58, 0),
    sMRZ(60, 0),
    sMRZ(62, 0),
    sMRZ(64, 0),
    sMRZ(66, 0),
    sMRZ(68, 0),
    sMRZ(70, 0),
    sMRZ(72, 0),
    sMRZ(74, 0),
    sMRZ(76, 0),
    sMRZ(78, 0),
    sMRZ(80, 0),
    sMRZ(1, 0),
    sMRZ(3, 0),
    sMRZ(5, 0),
    sMRZ(7, 0),
    sMRZ(9, 0),
    sMRZ(11, 0),
    sMRZ(13, 0),
    sMRZ(15, 0),
    sMRZ(17, 0),
    sMRZ(19, 0),
    sMRZ(21, 0),
    sMRZ(23, 0),
    sMRZ(25, 0),
    sMRZ(27, 0),
    sMRZ(29, 0),
    sMRZ(31, 0),
    sMRZ(33, 0),
    sMRZ(35, 0),
    sMRZ(37, 0),
    sMRZ(39, 0),
    sMRZ(41, 0),
    sMRZ(43, 0),
    sMRZ(45, 0),
    sMRZ(47, 0),
    sMRZ(49, 0),
    sMRZ(51, 0),
    sMRZ(53, 0),
    sMRZ(55, 0),
    sMRZ(57, 0),
    sMRZ(59, 0),
    sMRZ(61, 0),
    sMRZ(63, 0),
    sMRZ(65, 0),
    sMRZ(67, 0),
    sMRZ(69, 0),
    sMRZ(71, 0),
    sMRZ(73, 0),
    sMRZ(75, 0),
    sMRZ(77, 0),
    sMRZ(79, 0),
    sHadamard(9),
    sHadamard(11),
    sHadamard(13),
    sHadamard(15),
    sHadamard(17),
    sHadamard(27),
    sHadamard(29),
    sHadamard(31),
    sHadamard(33),
    sHadamard(35),
    sHadamard(45),
    sHadamard(47),
    sHadamard(49),
    sHadamard(51),
    sHadamard(53),
    sHadamard(63),
    sHadamard(65),
    sHadamard(67),
    sHadamard(69),
    sHadamard(71),
    #sCNOT(0, 1),
    sCNOT(2, 3),
    sCNOT(4, 5),
    sCNOT(6, 7),
    sCNOT(11, 10),
    sCNOT(13, 12),
    sCNOT(15, 14),
    sCNOT(17, 16),
    sCNOT(18, 19),
    sCNOT(20, 21),
    sCNOT(22, 23),
    sCNOT(24, 25),
    sCNOT(29, 28),
    sCNOT(31, 30),
    sCNOT(33, 32),
    sCNOT(35, 34),
    sCNOT(36, 37),
    sCNOT(38, 39),
    sCNOT(40, 41),
    sCNOT(42, 43),
    sCNOT(47, 46),
    sCNOT(49, 48),
    sCNOT(51, 50),
    sCNOT(53, 52),
    sCNOT(54, 55),
    sCNOT(56, 57),
    sCNOT(58, 59),
    sCNOT(60, 61),
    sCNOT(65, 64),
    sCNOT(67, 66),
    sCNOT(69, 68),
    sCNOT(71, 70),
    sCNOT(72, 73),
    sCNOT(74, 75),
    sCNOT(76, 77),
    sCNOT(78, 79),
    #sCNOT(9, 0),
    sCNOT(11, 2),
    sCNOT(13, 4),
    sCNOT(15, 6),
    sCNOT(17, 8),
    sCNOT(10, 19),
    sCNOT(12, 21),
    sCNOT(14, 23),
    sCNOT(16, 25),
    sCNOT(27, 18),
    sCNOT(29, 20),
    sCNOT(31, 22),
    sCNOT(33, 24),
    sCNOT(35, 26),
    sCNOT(28, 37),
    sCNOT(30, 39),
    sCNOT(32, 41),
    sCNOT(34, 43),
    sCNOT(45, 36),
    sCNOT(47, 38),
    sCNOT(49, 40),
    sCNOT(51, 42),
    sCNOT(53, 44),
    sCNOT(46, 55),
    sCNOT(48, 57),
    sCNOT(50, 59),
    sCNOT(52, 61),
    sCNOT(63, 54),
    sCNOT(65, 56),
    sCNOT(67, 58),
    sCNOT(69, 60),
    sCNOT(71, 62),
    sCNOT(64, 73),
    sCNOT(66, 75),
    sCNOT(68, 77),
    sCNOT(70, 79),
    sCNOT(10, 1),
    sCNOT(12, 3),
    sCNOT(14, 5),
    sCNOT(16, 7),
    sCNOT(9, 18),
    sCNOT(11, 20),
    sCNOT(13, 22),
    sCNOT(15, 24),
    sCNOT(17, 26),
    sCNOT(28, 19),
    sCNOT(30, 21),
    sCNOT(32, 23),
    sCNOT(34, 25),
    sCNOT(27, 36),
    sCNOT(29, 38),
    sCNOT(31, 40),
    sCNOT(33, 42),
    sCNOT(35, 44),
    sCNOT(46, 37),
    sCNOT(48, 39),
    sCNOT(50, 41),
    sCNOT(52, 43),
    sCNOT(45, 54),
    sCNOT(47, 56),
    sCNOT(49, 58),
    sCNOT(51, 60),
    sCNOT(53, 62),
    sCNOT(64, 55),
    sCNOT(66, 57),
    sCNOT(68, 59),
    sCNOT(70, 61),
    sCNOT(63, 72),
    sCNOT(65, 74),
    sCNOT(67, 76),
    sCNOT(69, 78),
    sCNOT(71, 80),
    sCNOT(2, 1),
    sCNOT(4, 3),
    sCNOT(6, 5),
    sCNOT(8, 7),
    sCNOT(9, 10),
    sCNOT(11, 12),
    sCNOT(13, 14),
    sCNOT(15, 16),
    sCNOT(20, 19),
    sCNOT(22, 21),
    sCNOT(24, 23),
    sCNOT(26, 25),
    sCNOT(27, 28),
    sCNOT(29, 30),
    sCNOT(31, 32),
    sCNOT(33, 34),
    sCNOT(38, 37),
    sCNOT(40, 39),
    sCNOT(42, 41),
    sCNOT(44, 43),
    sCNOT(45, 46),
    sCNOT(47, 48),
    sCNOT(49, 50),
    sCNOT(51, 52),
    sCNOT(56, 55),
    sCNOT(58, 57),
    sCNOT(60, 59),
    sCNOT(62, 61),
    sCNOT(63, 64),
    sCNOT(65, 66),
    sCNOT(67, 68),
    sCNOT(69, 70),
    sCNOT(74, 73),
    sCNOT(76, 75),
    sCNOT(78, 77),
    sCNOT(80, 79),
    sHadamard(9),
    sHadamard(11),
    sHadamard(13),
    sHadamard(15),
    sHadamard(17),
    sHadamard(27),
    sHadamard(29),
    sHadamard(31),
    sHadamard(33),
    sHadamard(35),
    sHadamard(45),
    sHadamard(47),
    sHadamard(49),
    sHadamard(51),
    sHadamard(53),
    sHadamard(63),
    sHadamard(65),
    sHadamard(67),
    sHadamard(69),
    sHadamard(71),
    sMRZ(1, 1),
    sMRZ(3, 2),
    sMRZ(5, 3),
    sMRZ(7, 4),
    sMRZ(9, 5),
    sMRZ(11, 6),
    sMRZ(13, 7),
    sMRZ(15, 8),
    sMRZ(17, 9),
    sMRZ(19, 10),
    sMRZ(21, 11),
    sMRZ(23, 12),
    sMRZ(25, 13),
    sMRZ(27, 14),
    sMRZ(29, 15),
    sMRZ(31, 16),
    sMRZ(33, 17),
    sMRZ(35, 18),
    sMRZ(37, 19),
    sMRZ(39, 20),
    sMRZ(41, 21),
    sMRZ(43, 22),
    sMRZ(45, 23),
    sMRZ(47, 24),
    sMRZ(49, 25),
    sMRZ(51, 26),
    sMRZ(53, 27),
    sMRZ(55, 28),
    sMRZ(57, 29),
    sMRZ(59, 30),
    sMRZ(61, 31),
    sMRZ(63, 32),
    sMRZ(65, 33),
    sMRZ(67, 34),
    sMRZ(69, 35),
    sMRZ(71, 36),
    sMRZ(73, 37),
    sMRZ(75, 38),
    sMRZ(77, 39),
    sMRZ(79, 40),
    sHadamard(9),
    sHadamard(11),
    sHadamard(13),
    sHadamard(15),
    sHadamard(17),
    sHadamard(27),
    sHadamard(29),
    sHadamard(31),
    sHadamard(33),
    sHadamard(35),
    sHadamard(45),
    sHadamard(47),
    sHadamard(49),
    sHadamard(51),
    sHadamard(53),
    sHadamard(63),
    sHadamard(65),
    sHadamard(67),
    sHadamard(69),
    sHadamard(71),
    #sCNOT(0, 1),
    sCNOT(2, 3),
    sCNOT(4, 5),
    sCNOT(6, 7),
    sCNOT(11, 10),
    sCNOT(13, 12),
    sCNOT(15, 14),
    sCNOT(17, 16),
    sCNOT(18, 19),
    sCNOT(20, 21),
    sCNOT(22, 23),
    sCNOT(24, 25),
    sCNOT(29, 28),
    sCNOT(31, 30),
    sCNOT(33, 32),
    sCNOT(35, 34),
    sCNOT(36, 37),
    sCNOT(38, 39),
    sCNOT(40, 41),
    sCNOT(42, 43),
    sCNOT(47, 46),
    sCNOT(49, 48),
    sCNOT(51, 50),
    sCNOT(53, 52),
    sCNOT(54, 55),
    sCNOT(56, 57),
    sCNOT(58, 59),
    sCNOT(60, 61),
    sCNOT(65, 64),
    sCNOT(67, 66),
    sCNOT(69, 68),
    sCNOT(71, 70),
    sCNOT(72, 73),
    sCNOT(74, 75),
    sCNOT(76, 77),
    sCNOT(78, 79),
    #sCNOT(9, 0),
    sCNOT(11, 2),
    sCNOT(13, 4),
    sCNOT(15, 6),
    sCNOT(17, 8),
    sCNOT(10, 19),
    sCNOT(12, 21),
    sCNOT(14, 23),
    sCNOT(16, 25),
    sCNOT(27, 18),
    sCNOT(29, 20),
    sCNOT(31, 22),
    sCNOT(33, 24),
    sCNOT(35, 26),
    sCNOT(28, 37),
    sCNOT(30, 39),
    sCNOT(32, 41),
    sCNOT(34, 43),
    sCNOT(45, 36),
    sCNOT(47, 38),
    sCNOT(49, 40),
    sCNOT(51, 42),
    sCNOT(53, 44),
    sCNOT(46, 55),
    sCNOT(48, 57),
    sCNOT(50, 59),
    sCNOT(52, 61),
    sCNOT(63, 54),
    sCNOT(65, 56),
    sCNOT(67, 58),
    sCNOT(69, 60),
    sCNOT(71, 62),
    sCNOT(64, 73),
    sCNOT(66, 75),
    sCNOT(68, 77),
    sCNOT(70, 79),
    sCNOT(10, 1),
    sCNOT(12, 3),
    sCNOT(14, 5),
    sCNOT(16, 7),
    sCNOT(9, 18),
    sCNOT(11, 20),
    sCNOT(13, 22),
    sCNOT(15, 24),
    sCNOT(17, 26),
    sCNOT(28, 19),
    sCNOT(30, 21),
    sCNOT(32, 23),
    sCNOT(34, 25),
    sCNOT(27, 36),
    sCNOT(29, 38),
    sCNOT(31, 40),
    sCNOT(33, 42),
    sCNOT(35, 44),
    sCNOT(46, 37),
    sCNOT(48, 39),
    sCNOT(50, 41),
    sCNOT(52, 43),
    sCNOT(45, 54),
    sCNOT(47, 56),
    sCNOT(49, 58),
    sCNOT(51, 60),
    sCNOT(53, 62),
    sCNOT(64, 55),
    sCNOT(66, 57),
    sCNOT(68, 59),
    sCNOT(70, 61),
    sCNOT(63, 72),
    sCNOT(65, 74),
    sCNOT(67, 76),
    sCNOT(69, 78),
    sCNOT(71, 80),
    sCNOT(2, 1),
    sCNOT(4, 3),
    sCNOT(6, 5),
    sCNOT(8, 7),
    sCNOT(9, 10),
    sCNOT(11, 12),
    sCNOT(13, 14),
    sCNOT(15, 16),
    sCNOT(20, 19),
    sCNOT(22, 21),
    sCNOT(24, 23),
    sCNOT(26, 25),
    sCNOT(27, 28),
    sCNOT(29, 30),
    sCNOT(31, 32),
    sCNOT(33, 34),
    sCNOT(38, 37),
    sCNOT(40, 39),
    sCNOT(42, 41),
    sCNOT(44, 43),
    sCNOT(45, 46),
    sCNOT(47, 48),
    sCNOT(49, 50),
    sCNOT(51, 52),
    sCNOT(56, 55),
    sCNOT(58, 57),
    sCNOT(60, 59),
    sCNOT(62, 61),
    sCNOT(63, 64),
    sCNOT(65, 66),
    sCNOT(67, 68),
    sCNOT(69, 70),
    sCNOT(74, 73),
    sCNOT(76, 75),
    sCNOT(78, 77),
    sCNOT(80, 79),
    sHadamard(9),
    sHadamard(11),
    sHadamard(13),
    sHadamard(15),
    sHadamard(17),
    sHadamard(27),
    sHadamard(29),
    sHadamard(31),
    sHadamard(33),
    sHadamard(35),
    sHadamard(45),
    sHadamard(47),
    sHadamard(49),
    sHadamard(51),
    sHadamard(53),
    sHadamard(63),
    sHadamard(65),
    sHadamard(67),
    sHadamard(69),
    sHadamard(71),
    sMRZ(1, 41),
    sMRZ(3, 42),
    sMRZ(5, 43),
    sMRZ(7, 44),
    sMRZ(9, 45),
    sMRZ(11, 46),
    sMRZ(13, 47),
    sMRZ(15, 48),
    sMRZ(17, 49),
    sMRZ(19, 50),
    sMRZ(21, 51),
    sMRZ(23, 52),
    sMRZ(25, 53),
    sMRZ(27, 54),
    sMRZ(29, 55),
    sMRZ(31, 56),
    sMRZ(33, 57),
    sMRZ(35, 58),
    sMRZ(37, 59),
    sMRZ(39, 60),
    sMRZ(41, 61),
    sMRZ(43, 62),
    sMRZ(45, 63),
    sMRZ(47, 64),
    sMRZ(49, 65),
    sMRZ(51, 66),
    sMRZ(53, 67),
    sMRZ(55, 68),
    sMRZ(57, 69),
    sMRZ(59, 70),
    sMRZ(61, 71),
    sMRZ(63, 72),
    sMRZ(65, 73),
    sMRZ(67, 74),
    sMRZ(69, 75),
    sMRZ(71, 76),
    sMRZ(73, 77),
    sMRZ(75, 78),
    sMRZ(77, 79),
    sMRZ(79, 80),
    sHadamard(9),
    sHadamard(11),
    sHadamard(13),
    sHadamard(15),
    sHadamard(17),
    sHadamard(27),
    sHadamard(29),
    sHadamard(31),
    sHadamard(33),
    sHadamard(35),
    sHadamard(45),
    sHadamard(47),
    sHadamard(49),
    sHadamard(51),
    sHadamard(53),
    sHadamard(63),
    sHadamard(65),
    sHadamard(67),
    sHadamard(69),
    sHadamard(71),
    #sCNOT(0, 1),
    sCNOT(2, 3),
    sCNOT(4, 5),
    sCNOT(6, 7),
    sCNOT(11, 10),
    sCNOT(13, 12),
    sCNOT(15, 14),
    sCNOT(17, 16),
    sCNOT(18, 19),
    sCNOT(20, 21),
    sCNOT(22, 23),
    sCNOT(24, 25),
    sCNOT(29, 28),
    sCNOT(31, 30),
    sCNOT(33, 32),
    sCNOT(35, 34),
    sCNOT(36, 37),
    sCNOT(38, 39),
    sCNOT(40, 41),
    sCNOT(42, 43),
    sCNOT(47, 46),
    sCNOT(49, 48),
    sCNOT(51, 50),
    sCNOT(53, 52),
    sCNOT(54, 55),
    sCNOT(56, 57),
    sCNOT(58, 59),
    sCNOT(60, 61),
    sCNOT(65, 64),
    sCNOT(67, 66),
    sCNOT(69, 68),
    sCNOT(71, 70),
    sCNOT(72, 73),
    sCNOT(74, 75),
    sCNOT(76, 77),
    sCNOT(78, 79),
    #sCNOT(9, 0),
    sCNOT(11, 2),
    sCNOT(13, 4),
    sCNOT(15, 6),
    sCNOT(17, 8),
    sCNOT(10, 19),
    sCNOT(12, 21),
    sCNOT(14, 23),
    sCNOT(16, 25),
    sCNOT(27, 18),
    sCNOT(29, 20),
    sCNOT(31, 22),
    sCNOT(33, 24),
    sCNOT(35, 26),
    sCNOT(28, 37),
    sCNOT(30, 39),
    sCNOT(32, 41),
    sCNOT(34, 43),
    sCNOT(45, 36),
    sCNOT(47, 38),
    sCNOT(49, 40),
    sCNOT(51, 42),
    sCNOT(53, 44),
    sCNOT(46, 55),
    sCNOT(48, 57),
    sCNOT(50, 59),
    sCNOT(52, 61),
    sCNOT(63, 54),
    sCNOT(65, 56),
    sCNOT(67, 58),
    sCNOT(69, 60),
    sCNOT(71, 62),
    sCNOT(64, 73),
    sCNOT(66, 75),
    sCNOT(68, 77),
    sCNOT(70, 79),
    sCNOT(10, 1),
    sCNOT(12, 3),
    sCNOT(14, 5),
    sCNOT(16, 7),
    sCNOT(9, 18),
    sCNOT(11, 20),
    sCNOT(13, 22),
    sCNOT(15, 24),
    sCNOT(17, 26),
    sCNOT(28, 19),
    sCNOT(30, 21),
    sCNOT(32, 23),
    sCNOT(34, 25),
    sCNOT(27, 36),
    sCNOT(29, 38),
    sCNOT(31, 40),
    sCNOT(33, 42),
    sCNOT(35, 44),
    sCNOT(46, 37),
    sCNOT(48, 39),
    sCNOT(50, 41),
    sCNOT(52, 43),
    sCNOT(45, 54),
    sCNOT(47, 56),
    sCNOT(49, 58),
    sCNOT(51, 60),
    sCNOT(53, 62),
    sCNOT(64, 55),
    sCNOT(66, 57),
    sCNOT(68, 59),
    sCNOT(70, 61),
    sCNOT(63, 72),
    sCNOT(65, 74),
    sCNOT(67, 76),
    sCNOT(69, 78),
    sCNOT(71, 80),
    sCNOT(2, 1),
    sCNOT(4, 3),
    sCNOT(6, 5),
    sCNOT(8, 7),
    sCNOT(9, 10),
    sCNOT(11, 12),
    sCNOT(13, 14),
    sCNOT(15, 16),
    sCNOT(20, 19),
    sCNOT(22, 21),
    sCNOT(24, 23),
    sCNOT(26, 25),
    sCNOT(27, 28),
    sCNOT(29, 30),
    sCNOT(31, 32),
    sCNOT(33, 34),
    sCNOT(38, 37),
    sCNOT(40, 39),
    sCNOT(42, 41),
    sCNOT(44, 43),
    sCNOT(45, 46),
    sCNOT(47, 48),
    sCNOT(49, 50),
    sCNOT(51, 52),
    sCNOT(56, 55),
    sCNOT(58, 57),
    sCNOT(60, 59),
    sCNOT(62, 61),
    sCNOT(63, 64),
    sCNOT(65, 66),
    sCNOT(67, 68),
    sCNOT(69, 70),
    sCNOT(74, 73),
    sCNOT(76, 75),
    sCNOT(78, 77),
    sCNOT(80, 79),
    sHadamard(9),
    sHadamard(11),
    sHadamard(13),
    sHadamard(15),
    sHadamard(17),
    sHadamard(27),
    sHadamard(29),
    sHadamard(31),
    sHadamard(33),
    sHadamard(35),
    sHadamard(45),
    sHadamard(47),
    sHadamard(49),
    sHadamard(51),
    sHadamard(53),
    sHadamard(63),
    sHadamard(65),
    sHadamard(67),
    sHadamard(69),
    sHadamard(71),
    sMRZ(1, 81),
    sMRZ(3, 82),
    sMRZ(5, 83),
    sMRZ(7, 84),
    sMRZ(9, 85),
    sMRZ(11, 86),
    sMRZ(13, 87),
    sMRZ(15, 88),
    sMRZ(17, 89),
    sMRZ(19, 90),
    sMRZ(21, 91),
    sMRZ(23, 92),
    sMRZ(25, 93),
    sMRZ(27, 94),
    sMRZ(29, 95),
    sMRZ(31, 96),
    sMRZ(33, 97),
    sMRZ(35, 98),
    sMRZ(37, 99),
    sMRZ(39, 100),
    sMRZ(41, 101),
    sMRZ(43, 102),
    sMRZ(45, 103),
    sMRZ(47, 104),
    sMRZ(49, 105),
    sMRZ(51, 106),
    sMRZ(53, 107),
    sMRZ(55, 108),
    sMRZ(57, 109),
    sMRZ(59, 110),
    sMRZ(61, 111),
    sMRZ(63, 112),
    sMRZ(65, 113),
    sMRZ(67, 114),
    sMRZ(69, 115),
    sMRZ(71, 116),
    sMRZ(73, 117),
    sMRZ(75, 118),
    sMRZ(77, 119),
    sMRZ(79, 120),
    sHadamard(9),
    sHadamard(11),
    sHadamard(13),
    sHadamard(15),
    sHadamard(17),
    sHadamard(27),
    sHadamard(29),
    sHadamard(31),
    sHadamard(33),
    sHadamard(35),
    sHadamard(45),
    sHadamard(47),
    sHadamard(49),
    sHadamard(51),
    sHadamard(53),
    sHadamard(63),
    sHadamard(65),
    sHadamard(67),
    sHadamard(69),
    sHadamard(71),
    #sCNOT(0, 1),
    sCNOT(2, 3),
    sCNOT(4, 5),
    sCNOT(6, 7),
    sCNOT(11, 10),
    sCNOT(13, 12),
    sCNOT(15, 14),
    sCNOT(17, 16),
    sCNOT(18, 19),
    sCNOT(20, 21),
    sCNOT(22, 23),
    sCNOT(24, 25),
    sCNOT(29, 28),
    sCNOT(31, 30),
    sCNOT(33, 32),
    sCNOT(35, 34),
    sCNOT(36, 37),
    sCNOT(38, 39),
    sCNOT(40, 41),
    sCNOT(42, 43),
    sCNOT(47, 46),
    sCNOT(49, 48),
    sCNOT(51, 50),
    sCNOT(53, 52),
    sCNOT(54, 55),
    sCNOT(56, 57),
    sCNOT(58, 59),
    sCNOT(60, 61),
    sCNOT(65, 64),
    sCNOT(67, 66),
    sCNOT(69, 68),
    sCNOT(71, 70),
    sCNOT(72, 73),
    sCNOT(74, 75),
    sCNOT(76, 77),
    sCNOT(78, 79),
    #sCNOT(9, 0),
    sCNOT(11, 2),
    sCNOT(13, 4),
    sCNOT(15, 6),
    sCNOT(17, 8),
    sCNOT(10, 19),
    sCNOT(12, 21),
    sCNOT(14, 23),
    sCNOT(16, 25),
    sCNOT(27, 18),
    sCNOT(29, 20),
    sCNOT(31, 22),
    sCNOT(33, 24),
    sCNOT(35, 26),
    sCNOT(28, 37),
    sCNOT(30, 39),
    sCNOT(32, 41),
    sCNOT(34, 43),
    sCNOT(45, 36),
    sCNOT(47, 38),
    sCNOT(49, 40),
    sCNOT(51, 42),
    sCNOT(53, 44),
    sCNOT(46, 55),
    sCNOT(48, 57),
    sCNOT(50, 59),
    sCNOT(52, 61),
    sCNOT(63, 54),
    sCNOT(65, 56),
    sCNOT(67, 58),
    sCNOT(69, 60),
    sCNOT(71, 62),
    sCNOT(64, 73),
    sCNOT(66, 75),
    sCNOT(68, 77),
    sCNOT(70, 79),
    sCNOT(10, 1),
    sCNOT(12, 3),
    sCNOT(14, 5),
    sCNOT(16, 7),
    sCNOT(9, 18),
    sCNOT(11, 20),
    sCNOT(13, 22),
    sCNOT(15, 24),
    sCNOT(17, 26),
    sCNOT(28, 19),
    sCNOT(30, 21),
    sCNOT(32, 23),
    sCNOT(34, 25),
    sCNOT(27, 36),
    sCNOT(29, 38),
    sCNOT(31, 40),
    sCNOT(33, 42),
    sCNOT(35, 44),
    sCNOT(46, 37),
    sCNOT(48, 39),
    sCNOT(50, 41),
    sCNOT(52, 43),
    sCNOT(45, 54),
    sCNOT(47, 56),
    sCNOT(49, 58),
    sCNOT(51, 60),
    sCNOT(53, 62),
    sCNOT(64, 55),
    sCNOT(66, 57),
    sCNOT(68, 59),
    sCNOT(70, 61),
    sCNOT(63, 72),
    sCNOT(65, 74),
    sCNOT(67, 76),
    sCNOT(69, 78),
    sCNOT(71, 80),
    sCNOT(2, 1),
    sCNOT(4, 3),
    sCNOT(6, 5),
    sCNOT(8, 7),
    sCNOT(9, 10),
    sCNOT(11, 12),
    sCNOT(13, 14),
    sCNOT(15, 16),
    sCNOT(20, 19),
    sCNOT(22, 21),
    sCNOT(24, 23),
    sCNOT(26, 25),
    sCNOT(27, 28),
    sCNOT(29, 30),
    sCNOT(31, 32),
    sCNOT(33, 34),
    sCNOT(38, 37),
    sCNOT(40, 39),
    sCNOT(42, 41),
    sCNOT(44, 43),
    sCNOT(45, 46),
    sCNOT(47, 48),
    sCNOT(49, 50),
    sCNOT(51, 52),
    sCNOT(56, 55),
    sCNOT(58, 57),
    sCNOT(60, 59),
    sCNOT(62, 61),
    sCNOT(63, 64),
    sCNOT(65, 66),
    sCNOT(67, 68),
    sCNOT(69, 70),
    sCNOT(74, 73),
    sCNOT(76, 75),
    sCNOT(78, 77),
    sCNOT(80, 79),
    sHadamard(9),
    sHadamard(11),
    sHadamard(13),
    sHadamard(15),
    sHadamard(17),
    sHadamard(27),
    sHadamard(29),
    sHadamard(31),
    sHadamard(33),
    sHadamard(35),
    sHadamard(45),
    sHadamard(47),
    sHadamard(49),
    sHadamard(51),
    sHadamard(53),
    sHadamard(63),
    sHadamard(65),
    sHadamard(67),
    sHadamard(69),
    sHadamard(71),
    sMRZ(1, 121),
    sMRZ(3, 122),
    sMRZ(5, 123),
    sMRZ(7, 124),
    sMRZ(9, 125),
    sMRZ(11, 126),
    sMRZ(13, 127),
    sMRZ(15, 128),
    sMRZ(17, 129),
    sMRZ(19, 130),
    sMRZ(21, 131),
    sMRZ(23, 132),
    sMRZ(25, 133),
    sMRZ(27, 134),
    sMRZ(29, 135),
    sMRZ(31, 136),
    sMRZ(33, 137),
    sMRZ(35, 138),
    sMRZ(37, 139),
    sMRZ(39, 140),
    sMRZ(41, 141),
    sMRZ(43, 142),
    sMRZ(45, 143),
    sMRZ(47, 144),
    sMRZ(49, 145),
    sMRZ(51, 146),
    sMRZ(53, 147),
    sMRZ(55, 148),
    sMRZ(57, 149),
    sMRZ(59, 150),
    sMRZ(61, 151),
    sMRZ(63, 152),
    sMRZ(65, 153),
    sMRZ(67, 154),
    sMRZ(69, 155),
    sMRZ(71, 156),
    sMRZ(73, 157),
    sMRZ(75, 158),
    sMRZ(77, 159),
    sMRZ(79, 160),
    sHadamard(9),
    sHadamard(11),
    sHadamard(13),
    sHadamard(15),
    sHadamard(17),
    sHadamard(27),
    sHadamard(29),
    sHadamard(31),
    sHadamard(33),
    sHadamard(35),
    sHadamard(45),
    sHadamard(47),
    sHadamard(49),
    sHadamard(51),
    sHadamard(53),
    sHadamard(63),
    sHadamard(65),
    sHadamard(67),
    sHadamard(69),
    sHadamard(71),
    #sCNOT(0, 1),
    sCNOT(2, 3),
    sCNOT(4, 5),
    sCNOT(6, 7),
    sCNOT(11, 10),
    sCNOT(13, 12),
    sCNOT(15, 14),
    sCNOT(17, 16),
    sCNOT(18, 19),
    sCNOT(20, 21),
    sCNOT(22, 23),
    sCNOT(24, 25),
    sCNOT(29, 28),
    sCNOT(31, 30),
    sCNOT(33, 32),
    sCNOT(35, 34),
    sCNOT(36, 37),
    sCNOT(38, 39),
    sCNOT(40, 41),
    sCNOT(42, 43),
    sCNOT(47, 46),
    sCNOT(49, 48),
    sCNOT(51, 50),
    sCNOT(53, 52),
    sCNOT(54, 55),
    sCNOT(56, 57),
    sCNOT(58, 59),
    sCNOT(60, 61),
    sCNOT(65, 64),
    sCNOT(67, 66),
    sCNOT(69, 68),
    sCNOT(71, 70),
    sCNOT(72, 73),
    sCNOT(74, 75),
    sCNOT(76, 77),
    sCNOT(78, 79),
    #sCNOT(9, 0),
    sCNOT(11, 2),
    sCNOT(13, 4),
    sCNOT(15, 6),
    sCNOT(17, 8),
    sCNOT(10, 19),
    sCNOT(12, 21),
    sCNOT(14, 23),
    sCNOT(16, 25),
    sCNOT(27, 18),
    sCNOT(29, 20),
    sCNOT(31, 22),
    sCNOT(33, 24),
    sCNOT(35, 26),
    sCNOT(28, 37),
    sCNOT(30, 39),
    sCNOT(32, 41),
    sCNOT(34, 43),
    sCNOT(45, 36),
    sCNOT(47, 38),
    sCNOT(49, 40),
    sCNOT(51, 42),
    sCNOT(53, 44),
    sCNOT(46, 55),
    sCNOT(48, 57),
    sCNOT(50, 59),
    sCNOT(52, 61),
    sCNOT(63, 54),
    sCNOT(65, 56),
    sCNOT(67, 58),
    sCNOT(69, 60),
    sCNOT(71, 62),
    sCNOT(64, 73),
    sCNOT(66, 75),
    sCNOT(68, 77),
    sCNOT(70, 79),
    sCNOT(10, 1),
    sCNOT(12, 3),
    sCNOT(14, 5),
    sCNOT(16, 7),
    sCNOT(9, 18),
    sCNOT(11, 20),
    sCNOT(13, 22),
    sCNOT(15, 24),
    sCNOT(17, 26),
    sCNOT(28, 19),
    sCNOT(30, 21),
    sCNOT(32, 23),
    sCNOT(34, 25),
    sCNOT(27, 36),
    sCNOT(29, 38),
    sCNOT(31, 40),
    sCNOT(33, 42),
    sCNOT(35, 44),
    sCNOT(46, 37),
    sCNOT(48, 39),
    sCNOT(50, 41),
    sCNOT(52, 43),
    sCNOT(45, 54),
    sCNOT(47, 56),
    sCNOT(49, 58),
    sCNOT(51, 60),
    sCNOT(53, 62),
    sCNOT(64, 55),
    sCNOT(66, 57),
    sCNOT(68, 59),
    sCNOT(70, 61),
    sCNOT(63, 72),
    sCNOT(65, 74),
    sCNOT(67, 76),
    sCNOT(69, 78),
    sCNOT(71, 80),
    sCNOT(2, 1),
    sCNOT(4, 3),
    sCNOT(6, 5),
    sCNOT(8, 7),
    sCNOT(9, 10),
    sCNOT(11, 12),
    sCNOT(13, 14),
    sCNOT(15, 16),
    sCNOT(20, 19),
    sCNOT(22, 21),
    sCNOT(24, 23),
    sCNOT(26, 25),
    sCNOT(27, 28),
    sCNOT(29, 30),
    sCNOT(31, 32),
    sCNOT(33, 34),
    sCNOT(38, 37),
    sCNOT(40, 39),
    sCNOT(42, 41),
    sCNOT(44, 43),
    sCNOT(45, 46),
    sCNOT(47, 48),
    sCNOT(49, 50),
    sCNOT(51, 52),
    sCNOT(56, 55),
    sCNOT(58, 57),
    sCNOT(60, 59),
    sCNOT(62, 61),
    sCNOT(63, 64),
    sCNOT(65, 66),
    sCNOT(67, 68),
    sCNOT(69, 70),
    sCNOT(74, 73),
    sCNOT(76, 75),
    sCNOT(78, 77),
    sCNOT(80, 79),
    sHadamard(9),
    sHadamard(11),
    sHadamard(13),
    sHadamard(15),
    sHadamard(17),
    sHadamard(27),
    sHadamard(29),
    sHadamard(31),
    sHadamard(33),
    sHadamard(35),
    sHadamard(45),
    sHadamard(47),
    sHadamard(49),
    sHadamard(51),
    sHadamard(53),
    sHadamard(63),
    sHadamard(65),
    sHadamard(67),
    sHadamard(69),
    sHadamard(71),
    sMRZ(1, 161),
    sMRZ(3, 162),
    sMRZ(5, 163),
    sMRZ(7, 164),
    sMRZ(9, 165),
    sMRZ(11, 166),
    sMRZ(13, 167),
    sMRZ(15, 168),
    sMRZ(17, 169),
    sMRZ(19, 170),
    sMRZ(21, 171),
    sMRZ(23, 172),
    sMRZ(25, 173),
    sMRZ(27, 174),
    sMRZ(29, 175),
    sMRZ(31, 176),
    sMRZ(33, 177),
    sMRZ(35, 178),
    sMRZ(37, 179),
    sMRZ(39, 180),
    sMRZ(41, 181),
    sMRZ(43, 182),
    sMRZ(45, 183),
    sMRZ(47, 184),
    sMRZ(49, 185),
    sMRZ(51, 186),
    sMRZ(53, 187),
    sMRZ(55, 188),
    sMRZ(57, 189),
    sMRZ(59, 190),
    sMRZ(61, 191),
    sMRZ(63, 192),
    sMRZ(65, 193),
    sMRZ(67, 194),
    sMRZ(69, 195),
    sMRZ(71, 196),
    sMRZ(73, 197),
    sMRZ(75, 198),
    sMRZ(77, 199),
    sMRZ(79, 200),
    #sMZ(0, 0),
    sMZ(2, 0),
    sMZ(4, 0),
    sMZ(6, 0),
    sMZ(8, 0),
    sMZ(10, 0),
    sMZ(12, 0),
    sMZ(14, 0),
    sMZ(16, 0),
    sMZ(18, 0),
    sMZ(20, 0),
    sMZ(22, 0),
    sMZ(24, 0),
    sMZ(26, 0),
    sMZ(28, 0),
    sMZ(30, 0),
    sMZ(32, 0),
    sMZ(34, 0),
    sMZ(36, 0),
    sMZ(38, 0),
    sMZ(40, 0),
    sMZ(42, 0),
    sMZ(44, 0),
    sMZ(46, 0),
    sMZ(48, 0),
    sMZ(50, 0),
    sMZ(52, 0),
    sMZ(54, 0),
    sMZ(56, 0),
    sMZ(58, 0),
    sMZ(60, 0),
    sMZ(62, 0),
    sMZ(64, 0),
    sMZ(66, 0),
    sMZ(68, 0),
    sMZ(70, 0),
    sMZ(72, 0),
    sMZ(74, 0),
    sMZ(76, 0),
    sMZ(78, 0),
    sMZ(80, 0),
];


function get_stats()
    # Powers of 2 to benchmark
    powers = 10:24
    n_values = 2 .^ powers

    cpu_times = Float64[]
    gpu_times = Float64[]
    for n in ProgressBar(n_values)
        time_cpu = @belapsed QuantumClifford.pftrajectories($circ; trajectories=$n)
        push!(cpu_times, time_cpu)

        # note. this is also measuring the time it takes to move data to gpu
        time_gpu = @belapsed QuantumCliffordGPU.pftrajectories($circ; trajectories=$n)
        push!(gpu_times, time_gpu)        
    end
    return n_values, cpu_times, gpu_times
end

n_values, cpu_times, gpu_times = get_stats()

normal_plot = plot(n_values, cpu_times, marker=:circle, label="cpu", xlabel="n", ylabel="Execution Time (s)", xscale=:log2, minorgrid=true)
plot!(n_values, gpu_times, marker=:circle, label="gpu", legend=:topleft)
title!("pftrajectories comparison on GPU and CPU")
xticks!(n_values[1:2:end])
times = union(gpu_times, cpu_times)
yticks!(times[times .> 7])
savefig("benchmark_surface_code_d5.png")

log_plot = plot(n_values, cpu_times, marker=:circle, label="cpu", xlabel="n", ylabel="Execution Time (s)", xscale=:log2, yscale=:log10, minorgrid=true)
plot!(n_values, gpu_times, marker=:circle, label="gpu", legend=:topleft)
title!("pftrajectories comparison on GPU and CPU (log)")
xticks!(n_values[1:2:end])
savefig("benchmark_surface_code_d5(log_scale).png")

